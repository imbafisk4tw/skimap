# Skigebiete Karte - Database V2
# Separate Instanz auf Port 5433

services:
  db:
    image: postgis/postgis:16-3.4
    container_name: skigebiete-v2
    restart: unless-stopped
    environment:
      POSTGRES_USER: ski
      POSTGRES_PASSWORD: ski
      POSTGRES_DB: skigebiete_v2
    ports:
      - "5433:5432"  # Anderer Port als V1 (5432)
    volumes:
      - skigebiete_v2_data:/var/lib/postgresql/data
      - ./schema_v2.sql:/docker-entrypoint-initdb.d/01_schema.sql:ro
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ski -d skigebiete_v2"]
      interval: 5s
      timeout: 3s
      retries: 30

volumes:
  skigebiete_v2_data:

# ============================================
# Verwendung:
# ============================================
#
# Starten:
#   cd db
#   docker-compose -f docker-compose-v2.yml up -d
#
# Verbinden (psql):
#   psql -h localhost -p 5433 -U ski -d skigebiete_v2
#
# Verbinden (Connection String):
#   postgresql://ski:ski@localhost:5433/skigebiete_v2
#
# Stoppen:
#   docker-compose -f docker-compose-v2.yml down
#
# Daten l√∂schen und neu starten:
#   docker-compose -f docker-compose-v2.yml down -v
#   docker-compose -f docker-compose-v2.yml up -d
